{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/actions.ts"],"sourcesContent":["\n'use server';\n\nimport { generatePetPortrait } from \"@/ai/flows/generate-pet-portrait\";\nimport type { GeneratePetPortraitInput } from \"@/ai/flows/types\";\nimport { adminStorage, adminDb } from '@/lib/firebase-admin';\nimport { randomUUID } from 'crypto';\n\n// Define the shape of the data returned by the actions\nexport interface GenerateActionResult {\n  success: boolean;\n  message: string;\n  portraitId?: string;\n  portraitDataUri?: string;\n};\n\nexport interface DeleteActionResult {\n  success: boolean;\n  message: string;\n}\n\nasync function savePortrait(\n  portraitDataUri: string,\n  petName: string,\n  hatStyle: string\n): Promise<string> {\n  const portraitId = randomUUID();\n  const buffer = Buffer.from(portraitDataUri.split(',')[1], 'base64');\n  const filePath = `portraits/${portraitId}.jpg`;\n  const file = adminStorage.bucket().file(filePath);\n\n  await file.save(buffer, {\n    metadata: { contentType: 'image/jpeg' },\n    public: true,\n  });\n\n  const publicUrl = file.publicUrl();\n\n  await adminDb.collection('portraits').doc(portraitId).set({\n    petName,\n    hatStyle,\n    imageUrl: publicUrl,\n    createdAt: new Date(),\n  });\n\n  return portraitId;\n}\n\n\n/**\n * A standard async function to handle portrait generation.\n * It's called from the client with a structured object.\n */\nexport async function handleGeneratePortrait(\n  input: GeneratePetPortraitInput\n): Promise<GenerateActionResult> {\n  // Basic validation\n  if (!input.petName || !input.photoDataUri || !input.hatStyle) {\n    return { success: false, message: 'Invalid form data. All fields are required.' };\n  }\n  \n  try {\n    const result = await generatePetPortrait(input);\n\n    if (!result.portraitDataUri) {\n        // This case should ideally not be hit if the flow works correctly.\n        return {\n          success: false,\n          message: 'AI generation failed to return a portrait. This may be due to a network error or a problem with the generation service.'\n        };\n    }\n    \n    // Convert to JPEG before saving to reduce file size\n    const jpegDataUri = await new Promise<string>((resolve) => {\n        const img = new (require('canvas').Image)();\n        img.onload = () => {\n            const canvas = require('canvas').createCanvas(img.width, img.height);\n            const ctx = canvas.getContext('2d');\n            ctx.drawImage(img, 0, 0);\n            resolve(canvas.toDataURL('image/jpeg', 0.9));\n        };\n        img.src = result.portraitDataUri;\n    });\n\n    const portraitId = await savePortrait(jpegDataUri, input.petName, input.hatStyle);\n\n    return {\n      success: true,\n      message: 'Your masterpiece is ready!',\n      portraitId: portraitId,\n      portraitDataUri: jpegDataUri,\n    };\n  } catch (error) {\n    console.error('Portrait generation error:', error);\n    // The flow now throws an error with a user-friendly message for invalid images.\n    const errorMessage = error instanceof Error ? error.message : 'An unknown error occurred during portrait generation.';\n    return {\n      success: false,\nmessage: errorMessage,\n    };\n  }\n}\n\n/**\n * A placeholder function to handle portrait deletion.\n * The gallery feature has been removed, so this is for compatibility.\n */\nexport async function handleDeletePortrait(portraitId: string): Promise<DeleteActionResult> {\n  console.log(`Attempted to delete portrait with ID: ${portraitId}`);\n  // Since there's no gallery, we can just return success.\n  return { success: true, message: 'Portrait deleted successfully.' };\n}\n"],"names":[],"mappings":";;;;;;IAqDsB,yBAAA,WAAA,GAAA,CAAA,GAAA,yNAAA,CAAA,wBAAA,EAAA,8CAAA,yNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,yNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\ninterface CardTitleProps extends React.HTMLAttributes<HTMLHeadingElement> {\n  as?: 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6';\n}\n\nconst CardTitle = React.forwardRef<\n  HTMLHeadingElement,\n  CardTitleProps\n>(({ className, as: Comp = 'div', ...props }, ref) => (\n  <Comp\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\n\ninterface CardDescriptionProps extends React.HTMLAttributes<HTMLParagraphElement> {\n  as?: React.ElementType;\n}\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  CardDescriptionProps\n>(({ className, as: Comp = 'div', ...props }, ref) => (\n  <Comp\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAGA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAMzB,MAAM,0BAAY,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAG/B,CAAC,EAAE,SAAS,EAAE,IAAI,OAAO,KAAK,EAAE,GAAG,OAAO,EAAE,oBAC5C,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAOxB,MAAM,gCAAkB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGrC,CAAC,EAAE,SAAS,EAAE,IAAI,OAAO,KAAK,EAAE,GAAG,OAAO,EAAE,oBAC5C,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,SAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/input.tsx"],"sourcesContent":["\nimport * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;AACA;AAEA;;;;AAEA,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAC3B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,6LAAC;QACC,MAAM;QACN,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,kYACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,MAAM,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB;AAGF,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,oKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG,oKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 201, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;AAAA;;;AAEA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OACkC;IACrC,qBACE,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,qCAAqC;QAClD,GAAG,KAAK;;;;;;AAGf;KAVS","debugId":null}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport {cn} from '@/lib/utils';\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(\n  ({className, ...props}, ref) => {\n    return (\n      <textarea\n        className={cn(\n          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nTextarea.displayName = 'Textarea';\n\nexport {Textarea};\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAC9B,CAAC,EAAC,SAAS,EAAE,GAAG,OAAM,EAAE;IACtB,qBACE,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 266, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/portrait-generator-form.tsx"],"sourcesContent":["\n'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport Image from 'next/image';\nimport { Camera, Sparkles, Wand2, ShoppingCart, RefreshCcw, Download, ArrowDown, Share2 } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { handleGeneratePortrait } from '@/app/actions';\nimport type { GenerateActionResult } from '@/app/actions';\n\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Textarea } from './ui/textarea';\nimport { cn } from '@/lib/utils';\nimport { useRouter } from 'next/navigation';\n\nconst allHatOptions = [\n  'Top Hat', 'Cowboy Hat', 'Beanie', 'Fez', 'Beret', 'Baseball Cap', \n  'Graduation Cap', 'Sombrero', 'Wizard Hat', 'Chef Hat', 'Sailor Hat', \n  'Detective Hat', 'Propeller Beanie', 'Crown', 'Viking Helmet', 'Pirate Hat',\n  'Hard Hat', 'Jester Hat', 'Bowler Hat', 'Fedora', 'Santa Hat', 'Elf Hat',\n  'Newsboy Cap', 'Turban', 'Ushanka', 'Safari Helmet', 'Mortar Board',\n  'Party Hat', 'Tricorne', 'Pork Pie Hat', 'Kepi', 'Deerstalker'\n];\n\nconst HATS_TO_SHOW = 15;\n\ntype PortraitState = 'idle' | 'generating' | 'generated';\n\nexport default function PortraitGeneratorForm() {\n  const { toast } = useToast();\n  const router = useRouter();\n  \n  // Form input state\n  const [photoPreview, setPhotoPreview] = useState<string | null>(null);\n  const [photoDataUri, setPhotoDataUri] = useState<string>('');\n  const [petName, setPetName] = useState('');\n  const [selectedHat, setSelectedHat] = useState('');\n  const [customHat, setCustomHat] = useState('');\n  \n  // Generation and UI flow state\n  const [portraitState, setPortraitState] = useState<PortraitState>('idle');\n  const [generatedPortraitUri, setGeneratedPortraitUri] = useState<string>('');\n  const [generatedPortraitId, setGeneratedPortraitId] = useState<string>('');\n  const [displayedHats, setDisplayedHats] = useState<string[]>([]);\n  const [isShareable, setIsShareable] = useState(false);\n  \n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const portraitSectionRef = useRef<HTMLDivElement>(null);\n  \n  const getHatStyle = () => customHat.trim() || selectedHat;\n  \n  const resetForRemix = () => {\n    setPortraitState('idle');\n    setGeneratedPortraitUri('');\n    setGeneratedPortraitId('');\n    setSelectedHat('');\n    setCustomHat('');\n  };\n  \n  const shuffleHats = () => {\n    const shuffled = [...allHatOptions].sort(() => 0.5 - Math.random());\n    setDisplayedHats(shuffled.slice(0, HATS_TO_SHOW));\n  };\n  \n  useEffect(() => {\n    shuffleHats();\n    if (navigator.share) {\n      setIsShareable(true);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (portraitState === 'generated') {\n      portraitSectionRef.current?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    }\n  }, [portraitState]);\n\n  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      setPhotoPreview(URL.createObjectURL(file));\n\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        const dataUri = reader.result as string;\n        setPhotoDataUri(dataUri);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n  \n  const handleGenerationSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    \n    const hatStyle = getHatStyle();\n\n    if (!photoDataUri) {\n      toast({ title: 'Oops!', description: 'Please upload a photo of your pet.', variant: 'destructive' });\n      return;\n    }\n    if (!petName) {\n      toast({ title: 'Oops!', description: \"Please enter your pet's name.\", variant: 'destructive' });\n      return;\n    }\n    if (!hatStyle) {\n      toast({ title: 'Oops!', description: 'Please select or describe a hat style.', variant: 'destructive' });\n      return;\n    }\n    \n    setPortraitState('generating');\n    setGeneratedPortraitUri('');\n    setGeneratedPortraitId('');\n\n    const result: GenerateActionResult = await handleGeneratePortrait({ petName, photoDataUri, hatStyle });\n    \n    if (result.success && result.portraitDataUri && result.portraitId) {\n      setGeneratedPortraitUri(result.portraitDataUri);\n      setGeneratedPortraitId(result.portraitId);\n      setPortraitState('generated');\n    } else {\n      toast({ \n        title: 'Generation Failed', \n        description: result.message || 'An unexpected error occurred. Please try again.', \n        variant: 'destructive',\n        duration: 9000,\n      });\n      setPortraitState('idle');\n    }\n  }\n\n  const handleHatSelect = (hat: string) => {\n    setSelectedHat(hat);\n    setCustomHat('');\n  }\n  \n  const handleCustomHatChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n      setCustomHat(e.target.value);\n      setSelectedHat('');\n  }\n\n  const handleDownload = () => {\n    if (!generatedPortraitUri) return;\n    const link = document.createElement('a');\n    link.href = generatedPortraitUri;\n\n    const petNameForFile = (petName || 'pet').toLowerCase().replace(/\\s+/g, '-');\n    const hatStyleForFile = (getHatStyle() || 'portrait').toLowerCase().replace(/\\s+/g, '-');\n    link.download = `${petNameForFile}-${hatStyleForFile}.jpg`;\n    \n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const handleShare = async () => {\n    if (!navigator.share) {\n      toast({\n        title: 'Sharing not available',\n        description: 'Your browser does not support the Web Share API.',\n        variant: 'destructive',\n      });\n      return;\n    }\n\n    const shareData = {\n        title: 'Licks & Lids',\n        text: `${petName} wearing a ${getHatStyle()} #LicksAndLids`,\n        url: 'https://www.licksandlids.com',\n    };\n\n    try {\n        await navigator.share(shareData);\n    } catch (error) {\n        if ((error as Error).name !== 'AbortError') {\n            console.error('Sharing failed', error);\n            toast({\n                title: 'Sharing failed',\n                description: 'There was an error trying to share your portrait.',\n                variant: 'destructive',\n            });\n        }\n    }\n  };\n\n  const isGenerating = portraitState === 'generating';\n\n  return (\n    <div className=\"space-y-8\">\n      <Card>\n        <CardHeader>\n          <CardTitle as=\"h2\">Create Your Masterpiece</CardTitle>\n          <CardDescription as=\"p\">Follow these simple steps to get a portrait of your furry friend.</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleGenerationSubmit} className=\"space-y-6\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"pet-photo\" className=\"text-base\">1. Upload a Photo</Label>\n              <div\n                className=\"relative flex justify-center items-center w-full h-48 md:h-64 border-2 border-dashed rounded-lg cursor-pointer hover:border-primary transition-colors\"\n                onClick={() => fileInputRef.current?.click()}\n                data-ai-hint=\"pet photo\"\n              >\n                {photoPreview ? (\n                  <>\n                  <Image\n                    src={photoPreview}\n                    alt=\"Pet preview\"\n                    fill\n                    className={cn(\"object-contain rounded-lg p-1\", isGenerating && \"opacity-50\")}\n                  />\n                  </>\n                ) : (\n                  <div className=\"text-center text-muted-foreground\">\n                    <Camera className=\"mx-auto h-12 w-12\" />\n                    <p>Click to upload a photo</p>\n                  </div>\n                )}\n              </div>\n              <Input\n                id=\"pet-photo\"\n                name=\"pet-photo-file\"\n                type=\"file\"\n                accept=\"image/*\"\n                ref={fileInputRef}\n                className=\"hidden\"\n                onChange={handleFileChange}\n                disabled={isGenerating}\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"petName\" className=\"text-base\">2. Name Your Pet</Label>\n              <Input\n                id=\"petName\"\n                name=\"petName\"\n                placeholder=\"e.g., Buddy\"\n                value={petName}\n                onChange={(e) => setPetName(e.target.value)}\n                disabled={isGenerating}\n              />\n            </div>\n\n           <div className=\"space-y-4\">\n              <Label className=\"text-base\">3. Choose a Hat Style</Label>\n              <div className=\"flex flex-wrap gap-2\">\n                {displayedHats.map((hat) => (\n                  <Button\n                    key={hat}\n                    type=\"button\"\n                    variant={selectedHat === hat ? 'default' : 'outline'}\n                    onClick={() => handleHatSelect(hat)}\n                    disabled={isGenerating}\n                  >\n                    {hat}\n                  </Button>\n                ))}\n                <Button\n                  type=\"button\"\n                  variant=\"secondary\"\n                  onClick={shuffleHats}\n                  disabled={isGenerating}\n                >\n                  <RefreshCcw className=\"mr-2 h-4 w-4\" />\n                  Shuffle Hats\n                </Button>\n              </div>\n               <Textarea\n                  name=\"customHatStyle\"\n                  placeholder=\"...or describe a custom hat in detail (e.g., 'a funky rainbow propeller hat')\"\n                  value={customHat}\n                  onChange={handleCustomHatChange}\n                  className=\"mt-2\"\n                  disabled={isGenerating}\n                />\n            </div>\n\n            <Button type=\"submit\" variant=\"accent\" size=\"lg\" className=\"w-full text-lg md:text-sm\" disabled={isGenerating}>\n              {isGenerating ? (\n                <>\n                  <Sparkles className=\"mr-2 h-4 w-4 animate-spin\" />\n                  Creating Magic...\n                </>\n              ) : (\n                <>\n                  <Wand2 className=\"mr-2 h-4 w-4\" />\n                  Generate Portrait\n                </>\n              )}\n            </Button>\n          </form>\n        </CardContent>\n      </Card>\n      \n      {(portraitState === 'generating' || portraitState === 'generated') && (\n        <div ref={portraitSectionRef}>\n          <div className=\"flex justify-center items-center text-muted-foreground my-4\">\n            <ArrowDown className=\"h-6 w-6 animate-bounce\" />\n          </div>\n          <Card className={cn(portraitState === 'generated' && 'animate-in fade-in zoom-in-95 duration-500')}>\n            <CardHeader>\n              <CardTitle as=\"h2\">Your Portrait</CardTitle>\n              <CardDescription as=\"p\">Behold! Your pet's masterpiece.</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"aspect-square w-full rounded-lg bg-muted flex items-center justify-center overflow-hidden\" data-ai-hint=\"generated portrait\">\n                {isGenerating ? (\n                  <div className=\"w-full h-full flex flex-col items-center justify-center space-y-4 bg-muted p-4\">\n                    <Skeleton className=\"h-full w-full\" />\n                    <p className=\"text-muted-foreground animate-pulse\">Dipping the brushes...</p>\n                  </div>\n                ) : (generatedPortraitUri &&\n                  <Image\n                    src={generatedPortraitUri}\n                    alt=\"Generated pet portrait\"\n                    width={512}\n                    height={512}\n                    className=\"object-cover w-full h-full transition-opacity duration-500 opacity-100\"\n                    priority\n                  />\n                )}\n              </div>\n            </CardContent>\n             {portraitState === 'generated' && (\n              <CardFooter className=\"flex-col gap-4\">\n                  <div className=\"w-full grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2\">\n                      <Button asChild variant=\"outline\" className=\"w-full\">\n                          <a\n                           href={`https://www.amazon.com/s?k=${encodeURIComponent((getHatStyle() || '') + ' for pet')}&tag=logonitro-20`}\n                           target=\"_blank\"\n                           rel=\"noopener noreferrer\"\n                          >\n                              <ShoppingCart /> \n                              Shop Look\n                          </a>\n                      </Button>\n                      <Button variant=\"outline\" className=\"w-full\" onClick={resetForRemix}>\n                          <RefreshCcw /> \n                          Create New\n                      </Button>\n                      <Button variant=\"outline\" className=\"w-full\" onClick={handleDownload}>\n                          <Download /> \n                           Download\n                      </Button>\n                      {isShareable && (\n                        <Button variant=\"outline\" className=\"w-full\" onClick={handleShare}>\n                            <Share2 /> \n                            Share\n                        </Button>\n                      )}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground text-center w-full pt-2\">\n                      As an Amazon Associate, we earn from qualifying purchases.\n                  </p>\n              </CardFooter>\n             )}\n          </Card>\n        </div>\n      )}\n    </div>\n  );\n}\n\n    \n\n    "],"names":[],"mappings":"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","debugId":null}}]
}