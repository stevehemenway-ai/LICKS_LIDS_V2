{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/hooks/use-mobile.tsx"],"sourcesContent":["import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n"],"names":[],"mappings":";;;AAAA;;;AAEA,MAAM,oBAAoB;AAEnB,SAAS;;IACd,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAc,AAAD,EAAuB;IAEpE,CAAA,GAAA,6JAAA,CAAA,YAAe,AAAD;iCAAE;YACd,MAAM,MAAM,OAAO,UAAU,CAAC,CAAC,YAAY,EAAE,oBAAoB,EAAE,GAAG,CAAC;YACvE,MAAM;kDAAW;oBACf,YAAY,OAAO,UAAU,GAAG;gBAClC;;YACA,IAAI,gBAAgB,CAAC,UAAU;YAC/B,YAAY,OAAO,UAAU,GAAG;YAChC;yCAAO,IAAM,IAAI,mBAAmB,CAAC,UAAU;;QACjD;gCAAG,EAAE;IAEL,OAAO,CAAC,CAAC;AACX;GAdgB","debugId":null}},
    {"offset": {"line": 44, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/url-compression.ts"],"sourcesContent":["import pako from 'pako';\n\n// Function to compress a string using pako (zlib) and then encode it for URL safety\nexport async function compressAndEncode(data: string): Promise<string> {\n    const compressed = pako.deflate(data, { to: 'string' });\n    // Using btoa for base64 encoding, then making it URL-safe\n    const base64 = btoa(compressed);\n    return base64.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n}\n\n// Function to decode a URL-safe string and then decompress it\nexport async function decodeAndDecompress(encoded: string): Promise<string> {\n    // Making the base64 string standard again\n    let base64 = encoded.replace(/-/g, '+').replace(/_/g, '/');\n    while (base64.length % 4) {\n        base64 += '=';\n    }\n    const compressed = atob(base64);\n    return pako.inflate(compressed, { to: 'string' });\n}\n\n// A simple check to see if a string is likely our compressed format\nexport function isCompressedAndEncoded(s: string): boolean {\n    // This is a basic check. A more robust check might involve trying to decode/decompress.\n    // It looks for URL-safe base64 characters and no data URI prefix.\n    return /^[A-Za-z0-9\\-_]+$/.test(s) && !s.startsWith('data:');\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAGO,eAAe,kBAAkB,IAAY;IAChD,MAAM,aAAa,+IAAA,CAAA,UAAI,CAAC,OAAO,CAAC,MAAM;QAAE,IAAI;IAAS;IACrD,0DAA0D;IAC1D,MAAM,SAAS,KAAK;IACpB,OAAO,OAAO,OAAO,CAAC,OAAO,KAAK,OAAO,CAAC,OAAO,KAAK,OAAO,CAAC,MAAM;AACxE;AAGO,eAAe,oBAAoB,OAAe;IACrD,0CAA0C;IAC1C,IAAI,SAAS,QAAQ,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM;IACtD,MAAO,OAAO,MAAM,GAAG,EAAG;QACtB,UAAU;IACd;IACA,MAAM,aAAa,KAAK;IACxB,OAAO,+IAAA,CAAA,UAAI,CAAC,OAAO,CAAC,YAAY;QAAE,IAAI;IAAS;AACnD;AAGO,SAAS,uBAAuB,CAAS;IAC5C,wFAAwF;IACxF,kEAAkE;IAClE,OAAO,oBAAoB,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,CAAC;AACxD","debugId":null}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\ninterface CardTitleProps extends React.HTMLAttributes<HTMLHeadingElement> {\n  as?: 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6';\n}\n\nconst CardTitle = React.forwardRef<\n  HTMLHeadingElement,\n  CardTitleProps\n>(({ className, as: Comp = 'div', ...props }, ref) => (\n  <Comp\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\n\ninterface CardDescriptionProps extends React.HTMLAttributes<HTMLParagraphElement> {\n  as?: React.ElementType;\n}\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  CardDescriptionProps\n>(({ className, as: Comp = 'div', ...props }, ref) => (\n  <Comp\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAGA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAMzB,MAAM,0BAAY,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAG/B,CAAC,EAAE,SAAS,EAAE,IAAI,OAAO,KAAK,EAAE,GAAG,OAAO,EAAE,oBAC5C,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAOxB,MAAM,gCAAkB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGrC,CAAC,EAAE,SAAS,EAAE,IAAI,OAAO,KAAK,EAAE,GAAG,OAAO,EAAE,oBAC5C,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,SAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 187, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/input.tsx"],"sourcesContent":["\nimport * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;AACA;AAEA;;;;AAEA,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAC3B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,6LAAC;QACC,MAAM;QACN,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,qXACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,MAAM,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB;AAGF,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,oKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG,oKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 262, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;AAAA;;;AAEA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OACkC;IACrC,qBACE,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,qCAAqC;QAClD,GAAG,KAAK;;;;;;AAGf;KAVS","debugId":null}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport {cn} from '@/lib/utils';\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(\n  ({className, ...props}, ref) => {\n    return (\n      <textarea\n        className={cn(\n          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nTextarea.displayName = 'Textarea';\n\nexport {Textarea};\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAC9B,CAAC,EAAC,SAAS,EAAE,GAAG,OAAM,EAAE;IACtB,qBACE,6LAAC;QACC,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,wSACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 327, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/portrait-generator-form.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport Image from 'next/image';\nimport Link from 'next/link';\nimport { Camera, Sparkles, Wand2, RefreshCcw, ArrowDown, Download, Share2 } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { cn } from '@/lib/utils';\nimport { useIsMobile } from '@/hooks/use-mobile';\nimport { compressAndEncode, isCompressedAndEncoded } from '@/lib/url-compression';\n\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Textarea } from './ui/textarea';\n\nconst allHatOptions = [\n  'Top Hat', 'Cowboy Hat', 'Beanie', 'Fez', 'Beret', 'Baseball Cap', \n  'Graduation Cap', 'Sombrero', 'Wizard Hat', 'Chef Hat', 'Sailor Hat', \n  'Detective Hat', 'Propeller Beanie', 'Crown', 'Viking Helmet', 'Pirate Hat',\n  'Hard Hat', 'Jester Hat', 'Bowler Hat', 'Fedora', 'Santa Hat', 'Elf Hat',\n  'Newsboy Cap', 'Turban', 'Ushanka', 'Safari Helmet', 'Mortar Board',\n  'Party Hat', 'Tricorne', 'Pork Pie Hat', 'Kepi', 'Deerstalker'\n];\n\nconst HATS_TO_SHOW = 15;\n\ntype PortraitState = 'idle' | 'generating' | 'generated';\n\n// A mock function to simulate the AI generation process.\nconst generateMockPortrait = (photoDataUri: string): Promise<string> => {\n    return new Promise(resolve => {\n        setTimeout(() => {\n            // In a real scenario, this would be the URI returned by the AI.\n            // For now, we'll just return the original photo URI to show the flow.\n            resolve(photoDataUri); \n        }, 2500);\n    });\n};\n\n\nexport default function PortraitGeneratorForm() {\n  const { toast } = useToast();\n  const isMobile = useIsMobile();\n  \n  // Form input state\n  const [photoPreview, setPhotoPreview] = useState<string | null>(null);\n  const [photoDataUri, setPhotoDataUri] = useState<string>('');\n  const [petName, setPetName] = useState('');\n  const [selectedHat, setSelectedHat] = useState('');\n  const [customHat, setCustomHat] = useState('');\n  \n  // Generation and UI flow state\n  const [portraitState, setPortraitState] = useState<PortraitState>('idle');\n  const [generatedPortraitUri, setGeneratedPortraitUri] = useState<string>('');\n  const [displayedHats, setDisplayedHats] = useState<string[]>([]);\n  \n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const portraitSectionRef = useRef<HTMLDivElement>(null);\n  \n  const getHatStyle = () => customHat.trim() || selectedHat;\n\n  const resetForm = () => {\n    setPhotoPreview(null);\n    setPhotoDataUri('');\n    setPetName('');\n    setSelectedHat('');\n    setCustomHat('');\n    setPortraitState('idle');\n    setGeneratedPortraitUri('');\n    if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n    }\n  };\n\n  const applyWatermarkAndConvertToJpeg = (dataUri: string): Promise<string> => {\n    return new Promise((resolve, reject) => {\n        const image = document.createElement('img');\n        image.onload = () => {\n            const canvas = document.createElement('canvas');\n            canvas.width = image.width;\n            canvas.height = image.height;\n            const ctx = canvas.getContext('2d');\n            if (!ctx) {\n                return reject(new Error('Could not get canvas context'));\n            }\n\n            // Draw the image\n            ctx.drawImage(image, 0, 0);\n\n            // Add watermark\n            ctx.font = '24px Poppins';\n            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';\n            ctx.textAlign = 'right';\n            ctx.fillText('LicksAndLids.com', canvas.width - 15, canvas.height - 15);\n            \n            // Convert to JPEG\n            resolve(canvas.toDataURL('image/jpeg', 0.9));\n        };\n        image.onerror = reject;\n        image.src = dataUri;\n    });\n  };\n\n  const handleDownload = async () => {\n    if (!generatedPortraitUri) return;\n    try {\n        const watermarkedUri = await applyWatermarkAndConvertToJpeg(generatedPortraitUri);\n        const link = document.createElement('a');\n        link.href = watermarkedUri;\n        const fileName = `${petName.toLowerCase().replace(/\\s/g, '-')}-in-a-${getHatStyle().toLowerCase().replace(/\\s/g, '-')}.jpg`;\n        \n        if (isMobile) {\n            // On mobile, downloading directly is often problematic. Open in new tab.\n            window.open(watermarkedUri, '_blank');\n        } else {\n            link.download = fileName;\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n        }\n    } catch (error) {\n        toast({ title: 'Download Failed', description: 'Could not prepare image for download.', variant: 'destructive'});\n    }\n  };\n\n  const handleShare = async () => {\n      if (!generatedPortraitUri) return;\n      try {\n        const watermarkedUri = await applyWatermarkAndConvertToJpeg(generatedPortraitUri);\n        const compressedData = await compressAndEncode(watermarkedUri);\n        const shareUrl = `${window.location.origin}/view/${compressedData}`;\n        \n        const hatStyle = getHatStyle();\n        const shareData = {\n            title: `Portrait of ${petName}`,\n            text: `Check out this portrait of my pet ${petName} wearing a ${hatStyle}! Created with Licks & Lids.`,\n            url: shareUrl,\n        };\n\n        if (navigator.share && navigator.canShare(shareData)) {\n            await navigator.share(shareData);\n        } else {\n            // Fallback for desktop or browsers that don't support sharing\n            await navigator.clipboard.writeText(shareUrl);\n            toast({ title: 'Link Copied!', description: 'Sharing is not supported on this browser. The link has been copied to your clipboard.'});\n        }\n      } catch (error) {\n          if ((error as Error).name !== 'AbortError') {\n            toast({ title: 'Share Failed', description: 'Could not prepare share link. Please try again.', variant: 'destructive' });\n          }\n      }\n  };\n  \n  const shuffleHats = () => {\n    const shuffled = [...allHatOptions].sort(() => 0.5 - Math.random());\n    setDisplayedHats(shuffled.slice(0, HATS_TO_SHOW));\n  };\n  \n  useEffect(() => {\n    shuffleHats();\n  }, []);\n\n  useEffect(() => {\n    if (portraitState === 'generated') {\n      portraitSectionRef.current?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    }\n  }, [portraitState]);\n\n  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      setPhotoPreview(URL.createObjectURL(file));\n\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        const dataUri = reader.result as string;\n        setPhotoDataUri(dataUri);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n  \n  const handleGenerationSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    \n    const hatStyle = getHatStyle();\n\n    if (!photoDataUri) {\n      toast({ title: 'Oops!', description: 'Please upload a photo of your pet.', variant: 'destructive' });\n      return;\n    }\n    if (!petName) {\n      toast({ title: 'Oops!', description: \"Please enter your pet's name.\", variant: 'destructive' });\n      return;\n    }\n    if (!hatStyle) {\n      toast({ title: 'Oops!', description: 'Please select or describe a hat style.', variant: 'destructive' });\n      return;\n    }\n    \n    setPortraitState('generating');\n    setGeneratedPortraitUri('');\n\n    try {\n        const resultUri = await generateMockPortrait(photoDataUri);\n        setGeneratedPortraitUri(resultUri);\n        setPortraitState('generated');\n    } catch (error) {\n        toast({ \n            title: 'Generation Failed', \n            description: 'Something went wrong. Please try again.', \n            variant: 'destructive'\n        });\n        setPortraitState('idle');\n    }\n  }\n\n  const handleHatSelect = (hat: string) => {\n    setSelectedHat(hat);\n    setCustomHat('');\n  }\n  \n  const handleCustomHatChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n      setCustomHat(e.target.value);\n      setSelectedHat('');\n  }\n\n  const isGenerating = portraitState === 'generating';\n\n  return (\n    <div className=\"space-y-8\">\n      <Card>\n        <CardHeader>\n          <CardTitle as=\"h2\" className=\"text-2xl sm:text-3xl\">Create Your Masterpiece</CardTitle>\n          <CardDescription as=\"p\" className=\"text-sm sm:text-base\">Follow these simple steps to get a portrait of your furry friend.</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleGenerationSubmit} className=\"space-y-6\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"pet-photo\" className=\"text-base\">1. Upload a Photo</Label>\n              <div\n                role=\"button\"\n                aria-label=\"Upload a photo of your pet\"\n                tabIndex={0}\n                className=\"relative flex justify-center items-center w-full h-48 md:h-64 border-2 border-dashed rounded-lg cursor-pointer hover:border-primary transition-colors\"\n                onClick={() => fileInputRef.current?.click()}\n                onKeyDown={(e) => { if (e.key === 'Enter' || e.key === ' ') fileInputRef.current?.click() }}\n              >\n                {photoPreview ? (\n                  <Image\n                    src={photoPreview}\n                    alt=\"Pet preview\"\n                    fill\n                    className={cn(\"object-contain rounded-lg p-1\", isGenerating && \"opacity-50\")}\n                  />\n                ) : (\n                  <div className=\"text-center text-muted-foreground\">\n                    <Camera className=\"mx-auto h-12 w-12\" />\n                    <p>Click to upload a photo</p>\n                  </div>\n                )}\n              </div>\n              <Input\n                id=\"pet-photo\"\n                name=\"pet-photo-file\"\n                type=\"file\"\n                accept=\"image/*\"\n                ref={fileInputRef}\n                className=\"hidden\"\n                onChange={handleFileChange}\n                disabled={isGenerating}\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"petName\" className=\"text-base\">2. Name Your Pet</Label>\n              <Input\n                id=\"petName\"\n                name=\"petName\"\n                placeholder=\"e.g., Buddy\"\n                value={petName}\n                onChange={(e) => setPetName(e.target.value)}\n                disabled={isGenerating}\n                className=\"text-base\"\n              />\n            </div>\n\n           <div className=\"space-y-4\">\n              <Label className=\"text-base\">3. Choose a Hat Style</Label>\n              <div className=\"flex flex-wrap gap-2\">\n                {displayedHats.map((hat) => (\n                  <Button\n                    key={hat}\n                    type=\"button\"\n                    variant={selectedHat === hat ? 'default' : 'outline'}\n                    onClick={() => handleHatSelect(hat)}\n                    disabled={isGenerating}\n                  >\n                    {hat}\n                  </Button>\n                ))}\n                <Button\n                  type=\"button\"\n                  variant=\"secondary\"\n                  onClick={shuffleHats}\n                  disabled={isGenerating}\n                >\n                  <RefreshCcw className=\"mr-2 h-4 w-4\" />\n                  Shuffle Hats\n                </Button>\n              </div>\n               <Textarea\n                  name=\"customHatStyle\"\n                  placeholder=\"...or describe a custom hat in detail (e.g., 'a funky rainbow propeller hat')\"\n                  value={customHat}\n                  onChange={handleCustomHatChange}\n                  className=\"mt-2 text-base\"\n                  disabled={isGenerating}\n                />\n            </div>\n\n            <Button type=\"submit\" variant=\"accent\" size=\"lg\" className=\"w-full text-base md:text-lg\" disabled={isGenerating}>\n              {isGenerating ? (\n                <>\n                  <Sparkles className=\"mr-2 h-4 w-4 animate-spin\" />\n                  Creating Magic...\n                </>\n              ) : (\n                <>\n                  <Wand2 className=\"mr-2 h-4 w-4\" />\n                  Generate Portrait\n                </>\n              )}\n            </Button>\n          </form>\n        </CardContent>\n      </Card>\n      \n      {(portraitState === 'generating' || portraitState === 'generated') && (\n        <div ref={portraitSectionRef}>\n          <div className=\"flex justify-center items-center text-muted-foreground my-4\">\n            <ArrowDown className=\"h-6 w-6 animate-bounce\" />\n          </div>\n          <Card className={cn(portraitState === 'generated' && 'animate-in fade-in zoom-in-95 duration-500')}>\n            <CardHeader>\n              <CardTitle as=\"h2\" className=\"text-2xl sm:text-3xl\">Your Portrait</CardTitle>\n              <CardDescription as=\"p\" className=\"text-sm sm:text-base\">Behold! Your pet's masterpiece.</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"aspect-square w-full rounded-lg bg-muted flex items-center justify-center overflow-hidden\">\n                {isGenerating ? (\n                  <div className=\"w-full h-full flex flex-col items-center justify-center space-y-4 bg-muted p-4\">\n                    <Skeleton className=\"h-full w-full\" />\n                    <p className=\"text-muted-foreground animate-pulse\">Dipping the brushes...</p>\n                  </div>\n                ) : (generatedPortraitUri &&\n                  <Image\n                    src={generatedPortraitUri}\n                    alt={`Generated portrait of ${petName} wearing a ${getHatStyle()}`}\n                    width={1024}\n                    height={1024}\n                    className=\"object-cover w-full h-full transition-opacity duration-500 opacity-100\"\n                    priority\n                  />\n                )}\n              </div>\n            </CardContent>\n             {portraitState === 'generated' && (\n                <CardFooter className=\"flex-col sm:flex-row gap-2 pt-4\">\n                    <Button onClick={handleDownload} className=\"flex-1\">\n                        <Download /> Download\n                    </Button>\n                    <Button onClick={handleShare} variant=\"secondary\" className=\"flex-1\">\n                        <Share2 /> Share\n                    </Button>\n                    <Button onClick={resetForm} variant=\"outline\" className=\"flex-1\">\n                      <RefreshCcw /> Create New\n                    </Button>\n                </CardFooter>\n             )}\n          </Card>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}